<!-- prescription-view-components.html -->
<div class="container mt-4" *ngIf="!isLoading; else loading">
  <div *ngIf="prescription; else errorTpl" class="card p-3" #prescriptionContent>
    <h3>Prescription Details (ID: {{ prescription.id }})</h3>
    <hr>

    <div class="row mb-2">
      <div class="col-md-6"><strong>Patient Name:</strong> {{ prescription.patientName }}</div>
      <div class="col-md-3"><strong>Age:</strong> {{ prescription.patientAge }}</div>
      <div class="col-md-3"><strong>Gender:</strong> {{ prescription.patientGender }}</div>
    </div>

    <div class="row mb-2">
      <div class="col-md-6"><strong>Diagnosis:</strong> {{ prescription.diagnosis }}</div>
      <div class="col-md-3"><strong>Prescription Date:</strong> {{ prescription.prescriptionDate | date:'yyyy-MM-dd' }}
      </div>
      <div class="col-md-3"><strong>Next Visit:</strong> {{ prescription.nextVisitDate | date:'yyyy-MM-dd' }}</div>
    </div>

    <h5 class="mt-3">Medicines</h5>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>#</th>
          <th>Medicine Name</th>
          <th>Dosage</th>
          <th>Frequency</th>
          <th>Duration (days)</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let med of prescription.medicines; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ med.medicineName }}</td>
          <td>{{ med.dosage }}</td>
          <td>{{ med.frequency }}</td>
          <td>{{ med.duration }}</td>
        </tr>
      </tbody>
    </table>

    <div class="text-center mt-3 button-group">
      <button class="btn btn-primary mt-3 me-2" (click)="savePDF()">Save PDF</button>
      <button class="btn btn-secondary mt-3" (click)="goBack()">Back</button>
    </div>
  </div>
</div>

<ng-template #loading>
  <div class="text-center mt-5">
    <div class="spinner-border text-primary"></div>
    <p>Loading prescription...</p>
  </div>
</ng-template>

<ng-template #errorTpl>
  <div class="alert alert-danger mt-3">
    {{ errorMessage }}
    <button class="btn btn-secondary btn-sm ms-2" (click)="goBack()">Back</button>
  </div>
</ng-template>